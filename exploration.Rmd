---
title: "exploration"
author: "Jordan Boswell and Thuy Nguyen"
date: "2/26/2022"
output: html_document
---

# Read data and format columns
```{r}
ship <- read.csv("train.csv")

ship$GID <- as.integer(substr(ship$PassengerId, 1,4))

ship$IID <- as.integer(substr(ship$PassengerId,6,8))

ship$GroupSize <- sapply(ship$GID, function(x){sum(ship$GID == x)})

ship$HomePlanet <- as.factor(ship$HomePlanet)

ship$CryoSleep <- as.logical(ship$CryoSleep)

ship$Deck <- as.character(mapply(function(x,y){if(nchar(x)==0){NULL}else{substr(x,y[2],y[3]-2)}},
                      ship$Cabin,
                      regexec("(.*?)/(.*?)/(.*)", ship$Cabin)))
ship$Num <- as.character(mapply(function(x,y){if(nchar(x)==0){NULL}else{substr(x,y[3],y[4]-2)}},
                      ship$Cabin,
                      regexec("(.*?)/(.*?)/(.*)", ship$Cabin)))
ship$Side <- as.character(mapply(function(x,y){if(nchar(x)==0){NULL}else{substr(x,y[4],nchar(x))}},
                      ship$Cabin,
                      regexec("(.*?)/(.*?)/(.*)", ship$Cabin)))

ship$Destination <- as.factor(ship$Destination)

ship$Age <- as.integer(ship$Age)

ship$VIP <- as.logical(ship$VIP)

ship$Transported <- as.logical(ship$Transported)

```

# Fixing missing data
```{r}
ship[ship$CryoSleep %in% T, c("RoomService", "FoodCourt", "ShoppingMall", "Spa", "VRDeck")] <- 0

```


# Other notes
Test and train's GID are disjoint.
```{r}
test <- read.csv("test.csv")
test$GID <- as.integer(substr(test$PassengerId, 1,4))
intersect(test$GID, ship$GID)
```

Each group is lost at most one person's cabin information.
```{r}
length(unique(ship$GID[ship$Cabin==""])) == length(ship$GID[ship$Cabin==""])
view(ship[ship$Deck =="NULL",])
```

Impute Cabin missing for people belong to a group.

```{r, warning=F}
for (i in 1:nrow(ship)){
  if (ship$IID[i] >1){
  
    ship$Cabin[i] = ship$Cabin[ship$GID==ship$GID[i]][1]
    ship$Deck[i] = ship$Deck[ship$GID==ship$GID[i]][1]
    ship$Num[i] = ship$Num[ship$GID==ship$GID[i]][1]
    ship$Side[i] = ship$Side[ship$GID==ship$GID[i]][1]
    
    }
}
```



